<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compost Cupid</title>
</head>
<style>
    *{
        margin: 0px;
        height: 100%;
    }
    body{
        display: flex; 
        align-items: center;
        justify-content: center;
        background-image: linear-gradient(0deg, rgb(209, 236, 207), rgb(69, 87, 69));
        color: white;
        font-family: system-ui, sans-serif;
    }
    #app-title{
        margin-top: 2.5rem;
    }
</style>
<body>
    <h1 id = "app-title">Compost Cupid</h1>
    <p>You've been matched with a bin: swipe right on items that belong and left on the rest!</p>
    <h1 id="app-title">Compost Cupid</h1>
    <div id="info">You are the <span id="binLabel"></span> bin</div>  <!-- where the bin is displayed -->
    <div id="card"> <!-- where the item is displayed -->
      <div id="cardEmoji"></div>
      <div id="cardName"></div>
    </div>
    <div id="feedback"></div><!-- where the feedback is displayed -->
    <div id="scoreDisplay">Score: 0 | Streak: 0</div><!-- where the score and streak are displayed -->
    <script>
        //BIN + ITEM CHOOSING LOGIC------------------------------------------
        const items = [
            { emoji: 'ðŸ“¦', name: 'Cardboard Box', bin: 'recycle' },
            { emoji: 'ðŸŒ', name: 'Banana Peel', bin: 'compost' },
            { emoji: 'ðŸª¥', name: 'Used Toothbrush', bin: 'trash' },
            { emoji: 'ðŸ•', name: 'Greasy Pizza Box', bin: 'trash' },
            { emoji: 'ðŸ¥«', name: 'Tomato Can', bin: 'recycle' },
            { emoji: 'â˜•', name: 'Ground Coffee', bin: 'compost' },
        ];
        let score = 0;
        let streak = 0;

        const bins = ['recycle', 'compost', 'trash'];//what bins can players be?

        function getNewBin(){ //pick a random bin at start of game
            let randomIndex = Math.floor(Math.random() * bins.length);
            let chosenBin = bins[randomIndex];
            return chosenBin;
        }
        let currBin = getNewBin(); //current bin that a player is assigned to

        let currItem = null;
        let binLabel = document.getElementById('binLabel'); //going into HTML and getting references to elements
        let cardEmoji = document.getElementById('cardEmoji');
        let cardName = document.getElementById('cardName');

        function showNextItem() { //pick a random item and display it on the card
            let randomIndex = Math.floor(Math.random() * items.length);
            currItem = items[randomIndex];
            cardEmoji.textContent = currItem.emoji;
            cardName.textContent = currItem.name;
        }

        //SWIPING LOGIC------------------------------------------------------
        let feedbackEl = document.getElementById('feedback');//points to feedback element in HTML
        let scoreEl = document.getElementById('scoreDisplay');//points to score display element in HTML

        function perSwipe(swipedRight) {
            let correct = (swipedRight === ((currItem.bin === currBin))); //check if the swipe direction matches the correct bin
            if (correct) {
                score++;
                streak++;
                feedbackEl.textContent = 'Correct!';
            } else {
                streak = 0;
                feedbackEl.textContent = 'Wrong! It was ' + currItem.bin;
            }
            scoreEl.textContent = 'Score: ' + score + ' | Streak: ' + streak;
            showNextItem();
        }

        let startX = 0;
        let card = document.getElementById('card');//points to HTML card

        card.addEventListener('touchstart', (e) => {
            startX = e.touches[0].clientX;   //touch[0] is first finger that touched screen,
                                            // clientX is horizontal position of that touch
        });

        card.addEventListener('touchend', (e) => { //constantly listening
            let endX = e.changedTouches[0].clientX;
            let diff = endX - startX;

            if (diff > 50) perSwipe(true);       // swiped right
            else if (diff < -50) perSwipe(false); // swiped left
        });

        // mouse events for desktop testing (Can be faded later)
        card.addEventListener('mousedown', (e) => { startX = e.clientX; });
        card.addEventListener('mouseup', (e) => {
            let diff = e.clientX - startX;
            if (diff > 50) perSwipe(true);
            else if (diff < -50) perSwipe(false);
        });

        //INITIALIZING STUFF------------------------------------------------------
        binLabel.textContent = currBin;
        showNextItem();

    </script>
</body>
</html>